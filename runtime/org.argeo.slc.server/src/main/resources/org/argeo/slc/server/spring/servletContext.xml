<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:aop="http://www.springframework.org/schema/aop"
	xmlns:tx="http://www.springframework.org/schema/tx"
	xsi:schemaLocation="
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
       http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd
       http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd"
	default-lazy-init="false">

	<!--  Properties -->
	<bean
		class="org.springframework.web.context.support.ServletContextPropertyPlaceholderConfigurer"
		lazy-init="false">
		<property name="contextOverride" value="true" />
		<property name="properties">
			<props>
				<prop key="sessionFactoryParentBean">
					slcServerDefault.sessionFactory.HSQL
                </prop>
			</props>
		</property>
		<property name="ignoreUnresolvablePlaceholders" value="true" />
	</bean>

	<import resource="transaction.xml" />
	<import resource="db.xml" />
	<import resource="activemq.xml" />

	<!-- Services -->
	<bean id="testManagerService" class="org.argeo.slc.services.impl.test.TestManagerServiceImpl">
		<constructor-arg ref="testResultDao" />
		<constructor-arg ref="testRunDescriptorDao" />
		<constructor-arg ref="slcExecutionDao" />
		<constructor-arg ref="testResultCollectionDao" />
	</bean>

	<bean id="agentService" class="org.argeo.slc.services.impl.runtime.AgentServiceImpl">
		<constructor-arg ref="slcAgentDescriptorDao" />
	</bean>

	<bean id="agentService.jmsContainer.register" parent="template.jms.listenerContainer">
		<property name="destination" ref="slcJms.destination.agent.register" />
		<property name="messageListener">
			<bean parent="template.jms.listenerAdapter">
				<constructor-arg ref="agentService" />
				<property name="defaultListenerMethod" value="register" />
			</bean>
		</property>
	</bean>

	<bean id="agentService.jmsContainer.unregister" parent="template.jms.listenerContainer">
		<property name="destination" ref="slcJms.destination.agent.unregister" />
		<property name="messageListener">
			<bean parent="template.jms.listenerAdapter">
				<constructor-arg ref="agentService" />
				<property name="defaultListenerMethod" value="unregister" />
			</bean>
		</property>
	</bean>

</beans>